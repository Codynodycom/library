# 5 Шаг. Загрузка победителей

Теперь, когда у нас реализована проверка победы, нужно позаботиться о сохранении и загрузке информации о победителях. Мы хотим, чтобы при запуске игры игроки видели доску лидеров, а победы сохранялись в отдельный файл для учета результатов.

### Хранение данных о победах

Мы будем сохранять имена игроков и количество их побед в текстовый файл. Это позволит отслеживать успехи игроков между сессиями игры. Структура файла будет простой: каждая строка будет содержать имя игрока и количество его побед, разделённые пробелом.

### Загрузка данных о победах

Для начала создадим функцию, которая будет загружать информацию о победителях из файла и преобразовывать её в удобную для использования структуру данных — словарь, где ключом будет имя игрока, а значением — количество его побед.

```python
def load_leaderboard(filename: str) -> dict:
    """
    Загружает доску лидеров из файла.
    Возвращает словарь с именами игроков и количеством их побед.
    """
    leaderboard = {}

    try:
        with open(filename, 'r') as file:
            for line in file:
                name, wins = line.strip().split()
                leaderboard[name] = int(wins)
    except FileNotFoundError:
        # Если файл не найден, создаём пустую доску лидеров
        pass

    return leaderboard
```

Эта функция читает файл построчно, извлекает имя игрока и количество побед, и сохраняет их в словарь. Если файл не найден, мы просто вернём пустой словарь, так как игра может запускаться впервые.

### Вывод доски лидеров

После того как мы загрузили данные, мы можем вывести их на экран, чтобы игроки видели текущие результаты.

```python
def show_leaderboard(leaderboard: dict):
    """
    Выводит доску лидеров на экран.
    """
    print("Доска лидеров:")
    for name, wins in sorted(leaderboard.items(), key=lambda item: item[1], reverse=True):
        print(f"{name}: {wins} побед(ы)")
```

Здесь мы сортируем игроков по количеству побед, чтобы выводить их в порядке убывания — от лидеров к менее успешным игрокам.

### Интеграция загрузки лидеров в основную игру

Теперь давайте загрузим доску лидеров при старте игры и выведем её перед запросом имен игроков.

```python
# Загрузка доски лидеров
leaderboard = load_leaderboard('leaderboard.txt')

# Вывод доски лидеров
show_leaderboard(leaderboard)

# Запрашиваем НИК для х
nikname_1 = input(NICKNAME_INPUT.format(1)).capitalize()
# Запрашиваем НИК для о
nikname_2 = input(NICKNAME_INPUT.format(2)).capitalize()
```

### Сохранение результатов после игры

Когда игра завершена, нам нужно обновить доску лидеров. Если победитель уже есть в списке, мы увеличиваем количество его побед. Если его там нет — добавляем нового игрока.

Для этого создадим функцию, которая будет обновлять файл с доской лидеров.

```python
def update_leaderboard(filename: str, leaderboard: dict, winner: str):
    """
    Обновляет доску лидеров после победы игрока и сохраняет её в файл.
    """
    if winner in leaderboard:
        leaderboard[winner] += 1
    else:
        leaderboard[winner] = 1

    with open(filename, 'w') as file:
        for name, wins in leaderboard.items():
            file.write(f"{name} {wins}\n")
```

### Добавление логики сохранения победителя

После того как определён победитель, мы будем вызывать функцию обновления доски лидеров:

```python
# Если есть победитель
if check_win(field, player_value):
    show_field()
    print(f"Поздравляем! Победитель: {player_name} ({player_value})")
    
    # Обновляем доску лидеров
    update_leaderboard('leaderboard.txt', leaderboard, player_name)
    
    break  # Завершаем игру
```

Теперь, после каждой игры, победитель будет добавляться на доску лидеров, и его результат будет сохранён в файл.

На этом этапе мы реализовали загрузку и сохранение результатов игры. Игроки смогут видеть свои достижения, а победы будут сохраняться между сессиями игры. Доска лидеров выводится при старте игры, и результаты обновляются автоматически после каждой победы.


